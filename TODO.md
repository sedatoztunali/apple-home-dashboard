# TODO

Bu dosya, geliştirme sırasında takip edeceğimiz işleri içerir. Her maddeye benzersiz bir kod atanır, oluşturulma/tamamlanma tarihleri ve bağımlılıklar belirtilir.

## Aktif İşler

- [ ] T-010 — Otomasyonlar modal'ı ile enable/disable yönetimi
  - Oluşturulma: 2025-11-01
  - Bağımlılıklar: —
  - Mevcut: Home Assistant'da birçok otomasyon var ancak dashboard üzerinden görüntülenemiyor ve enable/disable edilemiyor
  - Hedef:
    1. Ana ekranda (Home Page) Security, Lights gibi çiplerin sonuna "Automations" çipi eklenecek. Çip üzerinde kaç tane enabled otomasyon olduğu gösterilecek. Çipe tıklayınca modal açılacak.
    2. Room sayfalarında (Room Page) Security, Motion gibi status kartlarının sonuna "Automations" status kartı eklenecek. Üzerinde kaç tane enabled otomasyon olduğu gösterilecek (area bazında filtrelenmiş). Karta tıklayınca modal açılacak.
    3. Modal'da otomasyonlar kategori bazında gruplandırılacak ve enable/disable yapılabilecek.
  - Kapsam:
    - Yeni `AutomationManager.ts` utility sınıfı oluşturulması (`SectionReorderManager` benzeri yapı)
    - Modal'da otomasyonların listelenmesi (`hass.states` üzerinden `automation.` prefix'li entity'ler)
    - Göz ikonu ile enable/disable toggle (Reorder Sections modal'ındaki gibi)
    - Drag handle/reorder özelliği olmayacak (sadece liste görünecek)
    - Kategorilere göre gruplandırma (entity registry'den `category` field'ı, kategori yoksa "Uncategorized" veya "General")
    - **Ana ekranda çip eklenecek:**
      - `AppleChips.ts` içine "Automations" çipi eklenmesi (diğer çiplerden sonra)
      - Enabled otomasyon sayısının hesaplanması (tüm otomasyonlar içinden)
      - Çipe tıklayınca `AutomationManager` modal'ının açılması (area filtresi yok)
    - **Room sayfalarında status kartı eklenecek:**
      - `StatusSection.ts` içine "Automations" status kartı eklenmesi (`statusTypes` array'ine, en sona)
      - Enabled otomasyon sayısının hesaplanması (area'ya atanmış otomasyonlar içinden)
      - `DataService.groupEntitiesByArea()` veya benzer bir mantık ile area bazında filtreleme
      - Karta tıklayınca `AutomationManager` modal'ının açılması (area filtresi ile)
    - Area bazında filtreleme: Entity registry'de `area_id` field'ı kullanılabilir veya device üzerinden area'ya bağlanabilir
    - Enable/disable işlemleri: `hass.callService('automation', 'enable', { entity_id })` ve `hass.callService('automation', 'disable', { entity_id })`
    - Modal açılırken area parametresi geçilirse sadece o area'ya ait otomasyonlar gösterilecek
    - Çeviri anahtarları: `automations.title`, `automations.chip_label`, `automations.enabled`, `automations.disabled`, `automations.uncategorized`, `automations.count` (örn. "5 Enabled") (tüm dillere)
  - Kabul Kriterleri:
    - Ana ekranda çiplerin sonunda "Automations" çipi görünür
    - Çip üzerinde enabled otomasyon sayısı doğru gösterilir
    - Çipe tıklayınca modal açılır ve tüm otomasyonlar kategori bazında listelenir
    - Room sayfalarında status kartlarının sonunda "Automations" status kartı görünür
    - Status kartı üzerinde o area'ya ait enabled otomasyon sayısı doğru gösterilir
    - Status kartına tıklayınca modal açılır ve sadece o area'ya ait otomasyonlar kategori bazında listelenir
    - Modal'da otomasyonlar kategori bazında gruplandırılır (kategori varsa)
    - Göz ikonu ile enable/disable toggle çalışır
    - Enable/disable işlemleri Home Assistant'a başarıyla gönderilir
    - Modal görünümü "Reorder Sections" modal'ına benzer (drag handle yok)
    - Area filtresi doğru çalışır (room sayfalarında sadece o area'ya ait otomasyonlar gösterilir)
    - Build ve lint temiz

## Tamamlananlar

- [x] T-009 — Exclude from Dashboard'a status domain entity'lerini ekle
  - Oluşturulma: 2025-01-02
  - Tamamlanma: 2025-01-02
  - Bağımlılıklar: —
  - Mevcut: Home Settings'te "EXCLUDE FROM DASHBOARD" seçeneği var ancak sadece `SUPPORTED_DOMAINS` (light, switch, cover, climate, fan, media_player, lock, alarm_control_panel, scene, script, camera) içindeki entity'leri listeliyor. `STATUS_SECTION_DOMAINS` (sensor, binary_sensor) içindeki entity'ler listede görünmüyor. Bu yüzden temperature sensor'ları (örn. 3D printer temperature, power plug temperature) exclude edilemiyor. Ayrıca sadece 9-10 entity görünüyordu.
  - Hedef: "EXCLUDE FROM DASHBOARD" listesine `STATUS_SECTION_DOMAINS` (sensor, binary_sensor) içindeki entity'leri de ekle. Böylece kullanıcı temperature, humidity, motion, occupancy vb. tüm status chip entity'lerini exclude edebilsin.
  - Kapsam:
    - `HomeSettingsManager.loadAvailableEntities()` metodunu güncelle: hem `SUPPORTED_DOMAINS` hem de `STATUS_SECTION_DOMAINS` içindeki entity'leri listele
    - Entity filtreleme mantığını genişlet: `isSupportedDomain()` veya `STATUS_SECTION_DOMAINS` kontrolü yap
    - Switch filtreleme mantığı eklendi (`showSwitches` ve `includedSwitches` kontrolü)
    - Mevcut UI'ı değiştirmeye gerek yok (zaten "EXCLUDE FROM DASHBOARD" section'ı var)
    - Exclude edilen entity'ler tüm dashboard'tan (main dashboard, status chips, tüm sayfalar) tamamen kaldırılmalı
    - `CustomizationManager.isEntityExcludedFromDashboard()` zaten çalışıyor, sadece entity listesini genişletmek yeterli
  - Kabul Kriterleri:
    - ✅ Temperature, humidity, motion, occupancy, battery vb. sensor entity'leri "EXCLUDE FROM DASHBOARD" listesinde görünür
    - ✅ Bu entity'ler exclude edildiğinde dashboard'un her yerinden (status chips dahil) tamamen kaldırılır
    - ✅ Mevcut exclude mekanizması çalışmaya devam eder
    - ✅ Switch filtreleme mantığı doğru çalışır
    - ✅ Build ve lint temiz

- [x] T-008 — Entity isimlerini dashboard'da özelleştirme
  - Oluşturulma: 2025-10-31
  - Tamamlanma: 2025-10-31
  - Bağımlılıklar: —
  - Mevcut: Dashboard'da entity isimleri Home Assistant'daki `friendly_name` kullanıyor, değiştirilemiyor
  - Hedef: Dashboard'da entity isimlerini özelleştirebilme (HA entity isimlerini değiştirmeden)
  - Tercih: Edit Mode'da entity ismi üzerine tıklayınca inline edit veya modal ile isim değiştirme
  - Alternatif: En basit UI yöntemi (örn. Home Settings'te entity seçimi + isim input)
  - Kapsam:
    - CustomizationManager'a entity custom name kaydetme/okuma metotları (`setEntityCustomName`, `getEntityCustomName`)
    - Customizations yapısına `entities: { [entityId]: { custom_name: string } }` eklendi
    - AppleHomeCard'da öncelik sırası: `custom_name` → `this.name` → `friendly_name` → entity_id
    - Edit Mode'da entity card'ın isim kısmına tıklayınca inline edit input açılıyor (preferred)
    - Tüm sayfalarda custom name desteği eklendi (HomePage, RoomPage, GroupPage, ScenesPage, CamerasPage, tüm section'lar)
    - Custom name ayarlandığında sadece o dashboard'da görünür (kalıcı saklama)
    - Custom name silme/kaldırma seçeneği (boş/orijinal isme dönme)
    - Çeviri anahtarları eklendi (`edit.rename_entity`, `edit.custom_name`) - tüm dillere
  - Kabul Kriterleri:
    - ✅ Edit Mode'da entity ismi üzerine tıklayınca isim edit edilebilir
    - ✅ Değiştirilen isimler sadece bu dashboard'da görünür (HA entity isimleri değişmez)
    - ✅ Custom name ayarı kalıcı olarak saklanır (reload sonrası korunur)
    - ✅ Tüm sayfalarda (Home, Room, Group, Scenes, Cameras) custom name görünür
    - ✅ Custom name kaldırıldığında orijinal friendly_name görünür
    - ✅ Build ve lint hatasız tamamlandı

- [x] T-007 — Home Settings popup altında sürüm numarasını göster
  - Oluşturulma: 2025-10-31
  - Tamamlanma: 2025-10-31
  - Bağımlılıklar: —
  - Mevcut: Home Settings ile açılan popup’ta sürüm bilgisi görünmüyor
  - Hedef: Popup’ın en altında mevcut paket sürümünü (package.json version) göster
  - Kapsam:
    - `HomeSettingsManager` popup render’ında alt kısma sürüm etiketi eklendi
    - Sürüm `package.json` içinden import edilerek kullanıldı (tek kaynak)
    - Stil: küçük, ikincil/metin rengi; sağ altta
    - Çeviri: `settings.version_label` anahtarı tüm dillere eklendi
  - Kabul Kriterleri:
    - Home Settings popup’ında alt kısımda “Version: x.y.z” görünür
    - Tüm dillerde etiket çevrilidir
    - Build temiz

- [x] T-006 — Security chip altında kameralar her zaman görünsün
  - Oluşturulma: 2025-10-31
  - Tamamlanma: 2025-10-31
  - Bağımlılıklar: —
  - Mevcut: Kameralar Home ekranında "Reorder Sections" ile gizlenince, Security chip'e basıldığında da görünmüyor
  - Hedef: Security chip (Security filtresi) aktifken kameralar daima listelensin; Home görünümünde gizlenmiş olsa bile
  - Kapsam:
    - Security chip (filtresi) aktifken sadece kameralar için özel kural: `cameras_section` gizli olsa bile Security'de görünür olmalı
    - Diğer gizlenen bölümler Security'de de gizli kalmaya devam eder (genel override yok, sadece kameralar için özel durum)
    - `GroupPage.ts` içinde Security filtresi/State'i yakalayarak `CamerasSection` render koşullarını güncelle
    - `hiddenSections` kontrolünde Security filtresi aktifken `cameras_section` için istisna uygula
    - Çeviri anahtarı gerekmiyor (mevcut başlık/etiketler kullanılacak)
  - Kabul Kriterleri:
    - Home'da Cameras bölümü gizlense de Security chip'e basıldığında kameralar görünür
    - Build ve lint hatasız tamamlanır

- [x] T-005 — Commonly Used section (Manuel tracking)
  - Oluşturulma: 2025-10-30
  - Tamamlanma: 2025-10-30
  - Bağımlılıklar: —
  - Mevcut: Home ekranında sadece Favorites, Status, Rooms, Groups, Scenes, Cameras bölümleri var
  - Hedef: Son 24 saatte sık kullanılan varlıkları gösteren "Commonly Used" bölümü eklenmeli
  - Kapsam:
    - `UsageTracker` utility sınıfı: etkileşim tracking ve sıralama (Home Assistant storage)
    - `CommonlyUsedSection` component: FavoritesSection benzeri yapı
    - `AppleHomeCard.ts`: `handleCardClick` ve `handleIconClick` içine tracking ekleme
    - Action types: tap, toggle, more-info açma
    - **Filtreleme kriterleri:**
      - Minimum kullanım eşiği: Son 24 saatte en az 2-3 kez kullanılmış olmalı
      - Tek seferlik kullanımlar bölüme eklenmemeli
      - Sıralama: Kullanım sıklığı (ağırlık) + son kullanım zamanı (ağırlık) kombinasyonu
    - Son 24 saatteki etkileşimleri filtreleme ve sıralama algoritması
    - `HomePage.ts`: CommonlyUsedSection render'ı ekleme
    - Section sıralama ve gizleme desteği
    - Çeviri anahtarları (tüm dillerde): `section_titles.commonly_used`
    - Varsayılan sıralama: Favorites → Commonly Used → Cameras → Scenes → Areas
  - Kabul Kriterleri:
    - Son 24 saatte **sık kullanılan** (en az eşik değer kadar) varlıklar "Commonly Used" bölümünde görünür
    - Tek seferlik kullanımlar bölüme eklenmez
    - En çok kullanılanlar üstte, az kullanılanlar altta sıralanır
    - Boş olduğunda (eşik değeri aşan varlık yoksa) bölüm otomatik gizlenir
    - Etkileşimler kalıcı olarak saklanır (yeniden yüklemede korunur)
    - Build ve lint temiz

- [x] T-002 — Home Wallpaper kaldırma seçeneği
  - Oluşturulma: 2025-10-30
  - Tamamlanma: 2025-10-30
  - Bağımlılıklar: —
  - Mevcut: "Home Settings" içinde duvar kâğıdı olarak bir resim seçilebiliyor
  - Hedef: Arka plan resmini tamamen kaldır (theme varsayılan arka planına dön) seçeneği eklenebilmeli
  - Kapsam:
    - Home Settings UI'ına "Remove wallpaper" / "Clear background" seçeneği eklenmesi
    - `BackgroundManager`'a `removeWallpaper()` metodu eklenmesi
    - Theme varsayılan arka planı: `https://raw.githubusercontent.com/Stormrage-DJ/ha_theme_star_wars_light/main/assets/star_wars_light_bg.png`
    - Theme background CSS: `top center / auto no-repeat url(...) fixed`
    - Arka plan temizlendiğinde theme background'unun uygulanması
    - `CustomizationManager` üzerinde theme durumunun kalıcı saklanması
    - Uygulandığında anında görünümün güncellenmesi ve reload sonrası kalıcılık
  - Kabul Kriterleri:
    - Kullanıcı ayardan arka planı kaldırdığında theme varsayılan arka planı uygulanır
    - Theme background CSS özellikleri doğru uygulanır (position: top center, size: auto, no-repeat, fixed)
    - Ayar kalıcıdır, yeniden yüklemede korunur
    - Build ve lint temiz

## Tamamlananlar

- [x] T-004 — Tam rebranding: Smart Home
  - Oluşturulma: 2025-10-30
  - Tamamlanma: 2025-10-30
  - Bağımlılıklar: —
  - Kapsam:
    - Strategy tipi: `custom:smart-home-strategy` (kayıt ve README örnekleri güncellendi)
    - Görünüm tipi: `custom:smart-home-view`, custom element: `smart-home-view`
    - HACS adı ve dosya adı: `Smart Home Dashboard Strategy`, `smart-home-dashboard.js`
    - Webpack çıktı adı ve paket `main`: `smart-home-dashboard.js`
    - README kaynak URL’leri ve yönergeler Smart Home olarak güncellendi
  - Kabul Kriterleri:
    - Kullanıcıya görünen ad/etiket ve kaynak adları “Smart Home” olarak geçiyor
    - HACS kaydı ve dosya adı tutarlı: `smart-home-dashboard.js`
    - Strategy tipi/yaml örnekleri `custom:smart-home-strategy`
    - Build ve lint temiz

- [x] T-001 — Görünüm adı değişikliği
  - Oluşturulma: 2025-10-30
  - Tamamlanma: 2025-10-30
  - Bağımlılıklar: —
  - Mevcut: `custom:apple-home-view`
  - Hedef: `custom:smart-home-view`
  - Kapsam:
    - Strategy konfigürasyon üretiminde kart tipinin `custom:smart-home-view` olarak kullanılması
    - Web component kayıt adının güncellenmesi (custom element tanımı)
    - İlgili import/usage noktalarının uyarlanması
    - Eski ad tamamen kaldırıldı; herhangi bir alias/geriye uyumluluk yok
  - Kabul Kriterleri:
    - Strategy ile oluşturulan tüm sayfalar `custom:smart-home-view` ile render ediliyor
    - Kod tabanında `custom:apple-home-view` referansı kalmadı
    - Konsolda hata yok, build ve lint temiz

- [x] T-003 — Türkçe ve Hollandaca çeviriler
  - Oluşturulma: 2025-10-30
  - Tamamlanma: 2025-10-30
  - Bağımlılıklar: —
  - Mevcut: `src/translations` altında dil dosyaları mevcut
  - Hedef: Türkçe (`tr.json`) eklenmesi ve Hollandaca (`nl.json`) içeriğinin gözden geçirilmesi/güncellenmesi
  - Kapsam:
    - `tr.json` dosyasının oluşturulması (tüm anahtarlar için çeviri)
    - `nl.json` eksik/yanlış kalemlerin tamamlanması
    - `LocalizationService` ile bütünleşik çalıştığının doğrulanması
  - Kabul Kriterleri:
    - Dil `tr` seçildiğinde tüm etiketler Türkçe görüntülenir
    - Dil `nl` seçildiğinde eksik etiket kalmaz
    - Build ve lint temiz
